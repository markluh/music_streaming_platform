{% load static %}

{% if music_results %}
    <div class="music-grid">
    {% for music in music_results %}
        <div class="music-item">
            <div class="uploader-info">
                <a href="{% url 'user_profile' username=music.uploaded_by.username %}" class="ajax-link">
                    <img src="{% if music.uploaded_by.userprofile.profile_picture %}{{ music.uploaded_by.userprofile.profile_picture.url }}{% else %}{% static 'images/default_profile_pic.png' %}{% endif %}" 
                         class="profile-pic-small" 
                         alt="{{ music.uploaded_by.username }}'s profile picture">
                </a>
                <a href="{% url 'user_profile' username=music.uploaded_by.username %}" class="ajax-link">
                    <span>{{ music.uploaded_by.username }}</span>
                </a>
            </div>

            <div class="music-body">
                <span class="music-title">{{ music.title }} by {{ music.artist }}</span>
                <a href="#" class="play-btn" 
                   data-src="{{ music.file_path.url }}"
                   data-title="{{ music.title }}" 
                   data-artist="{{ music.artist }}"
                   data-uploader-pic="{% if music.uploaded_by.userprofile.profile_picture %}{{ music.uploaded_by.userprofile.profile_picture.url }}{% else %}{% static 'images/default_profile_pic.png' %}{% endif %}">
                    ▶️ Play
                </a>
            </div>
        </div>
    {% endfor %}
    </div>
{% else %}
    <p>No music found for your search query.</p>
{% endif %}